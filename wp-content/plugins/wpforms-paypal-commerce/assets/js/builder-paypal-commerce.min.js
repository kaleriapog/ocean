"use strict";var WPFormsBuilderPaypalCommerce=window.WPFormsBuilderPaypalCommerce||function(e,l){var n={},a={init:function(){l(a.ready)},ready:function(){n={$AJAXSubmitOption:l("#wpforms-panel-field-settings-ajax_submit"),$alert:l("#wpforms-paypal-commerce-credit-card-alert"),$alertPaypalStandard:l("#wpforms-paypal-commerce-paypal-standard-alert"),$paypalStandardToggle:l("#wpforms-panel-field-paypal_standard-enable"),$panelContent:l("#wpforms-panel-content-section-payment-paypal-commerce"),$buttonsWrapper:l("#wpforms-paypal-commerce-buttons-wrapper"),$checkoutButton:l("#wpforms-paypal-commerce-paypal-checkout-button"),$checkoutButtonLogo:l("#wpforms-paypal-commerce-paypal-checkout-button-logo")},a.bindOptionsActions(),a.bindUIActions(),a.hideSubmitDefault(),a.disableFields()},bindUIActions:function(){l(e).on("wpformsSaved",function(e,o){a.ajaxRequiredCheck(),a.paymentsEnabledCheck(),a.updatePlanData(o),a.disableFields()}),l(e).on("wpformsBeforeSave",a.paypalStandardEnabledCheck).on("wpformsFieldAdd",a.fieldAdded).on("wpformsFieldDelete",a.fieldDeleted),n.$cardButton.on("click",a.connectionCheck),n.$paypalStandardToggle.on("change",a.paypalStandardToggle)},bindGenericConstants:function(){n.$fieldOptions=l(".wpforms-field-option-paypal-commerce"),n.$fieldPreview=l("#wpforms-panel-fields .wpforms-field.wpforms-field-paypal-commerce")},bindOptionsActions:function(){a.bindGenericConstants(),n.$singlePaymentControl=l("#wpforms-panel-field-paypal_commerce-enable_one_time"),n.$recurringPaymentControl=l("#wpforms-panel-field-paypal_commerce-enable_recurring"),n.$singlePaymentSettings=l("#paypal-commerce-provider .wpforms-paypal-commerce-panel-fields"),n.$cardButton=l("#wpforms-add-fields-paypal-commerce"),n.$singlePaymentControl.on("change",a.singleSettingsToggle),n.$fieldOptions.find(".wpforms-field-option-paypal-checkout").on("change",a.paypalCheckoutMethodToggle),n.$fieldOptions.find(".wpforms-field-option-credit-card").on("change",a.creditCardMethodToggle),n.$fieldOptions.find(".wpforms-field-option-row-credit_cards input").on("change",a.creditCardTypeToggle),n.$fieldOptions.find(".wpforms-field-option-row-default_method select").on("change",a.defaultMethodSelect),n.$fieldOptions.find('.wpforms-field-option-row-card_holder input[type="checkbox"]').on("change",a.cardHolderToggle),n.$fieldOptions.find('.wpforms-field-option-row-sublabels input[type="text"]').on("change",a.cardSublabels),n.$fieldOptions.find(".wpforms-field-option-row-button_size select").on("change",a.optionButtonSizeChange),n.$fieldOptions.find(".wpforms-field-option-row-shape select").on("change",a.optionShapeChange),n.$fieldOptions.find(".wpforms-field-option-row-color select").on("change",a.optionColorChange)},ajaxRequiredCheck:function(){!a.isTargetFieldAdded()||a.isAJAXSubmitEnabled()||l.alert({title:wpforms_builder.heads_up,content:wpforms_builder.paypal_commerce_ajax_required,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})},isTargetFieldAdded:function(){return 0<n.$fieldPreview.length},paymentsEnabledCheck:function(){!l("#wpforms-panel-fields .wpforms-field.wpforms-field-paypal-commerce").length||a.isPaymentsEnabled()||(n.$panelContent.find(".wpforms-panel-content-section-payment-one-time").hide(),n.$panelContent.find(".wpforms-panel-content-section-payment-recurring").hide(),l.alert({title:wpforms_builder.heads_up,content:wpforms_builder.paypal_commerce_payments_enabled_required,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}))},paypalStandardEnabledCheck:function(){n.$paypalStandardToggle.prop("checked")&&a.unCheckEnabledPayments()},connectionCheck:function(){if(!l(this).hasClass("wpforms-add-fields-button-disabled")){if(!l(this).hasClass("paypal-commerce-connection-required"))return!0;l.alert({title:wpforms_builder.heads_up,content:wpforms_builder.paypal_commerce_connection_required,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})}return!1},fieldAdded:function(e,o,t){"paypal-commerce"!==t?a.bindGenericConstants():(a.paymentsEnabledCheck(),a.bindOptionsActions(),a.cardButtonToggle(!0),a.settingsToggle(!0),n.$buttonsWrapper.removeClass("wpforms-hidden"),n.$fieldPreview.find(".wpforms-paypal-commerce-credit-card-warning").removeClass("wpforms-hidden")),a.hideSubmitDefault()},fieldDeleted:function(e,o,t){"paypal-commerce"===t&&(a.cardButtonToggle(!1),a.settingsToggle(!1),a.disableNotifications(),n.$buttonsWrapper.addClass("wpforms-hidden"),l(".wpforms-preview .no-fields-preview").length||l(".wpforms-preview .wpforms-field-submit").show())},cardButtonToggle:function(e){n.$cardButton.prop("disabled",e).toggleClass("wpforms-add-fields-button-disabled",e)},settingsToggle:function(e){!n.$alert.length&&!n.$panelContent.length||n.$paypalStandardToggle.prop("checked")||(n.$alert.toggleClass("wpforms-hidden",e),n.$panelContent.toggleClass("wpforms-hidden",!e),e||a.unCheckEnabledPayments())},singleSettingsToggle:function(e){n.$singlePaymentSettings.toggleClass("wpforms-hidden",!e.target.checked)},paypalCheckoutMethodToggle:function(e){var o=a.isCreditCardEnabled(),t="paypal_checkout"===n.$fieldOptions.find(".wpforms-field-option-row-default_method select").val();n.$fieldPreview.find(".wpforms-paypal-commerce-paypal-checkout-warning").toggleClass("wpforms-hidden",!e.target.checked||o),n.$fieldPreview.find(".wpforms-paypal-commerce-credit-card-warning").toggleClass("wpforms-hidden",!e.target.checked||!o||!t),n.$fieldOptions.find(".wpforms-field-option-row-button_size").toggleClass("wpforms-hidden",!e.target.checked),n.$fieldOptions.find(".wpforms-field-option-row-button_size").toggleClass("wpforms-hidden",!e.target.checked),n.$fieldOptions.find(".wpforms-field-option-row-shape").toggleClass("wpforms-hidden",!e.target.checked),n.$fieldOptions.find(".wpforms-field-option-row-color").toggleClass("wpforms-hidden",!e.target.checked),n.$buttonsWrapper.toggleClass("wpforms-hidden",!e.target.checked),a.hideSubmitDefault(),a.paymentMethodToggle()},paypalStandardToggle:function(e){e=e.target.checked&&!l("#wpforms-panel-field-settings-disable_entries").prop("checked");n.$alertPaypalStandard.toggleClass("wpforms-hidden",!e),(a.isTargetFieldAdded()?n.$panelContent:n.$alert).toggleClass("wpforms-hidden",e)},creditCardMethodToggle:function(e){var o=a.isCheckoutEnabled(),t="credit_card"===n.$fieldOptions.find(".wpforms-field-option-row-default_method select").val();n.$fieldOptions.find(".wpforms-field-option-row-credit_cards").toggleClass("wpforms-hidden",!e.target.checked),n.$fieldOptions.find(".wpforms-field-option-row-sublabels").toggleClass("wpforms-hidden",!e.target.checked),n.$fieldPreview.find(".wpforms-paypal-commerce-credit-card-warning").toggleClass("wpforms-hidden",!e.target.checked||t||!o),n.$fieldPreview.find(".wpforms-paypal-commerce-paypal-checkout-warning").toggleClass("wpforms-hidden",e.target.checked||!o),n.$fieldPreview.find(".wpforms-paypal-commerce-credit-card-fields").toggleClass("wpforms-hidden",!e.target.checked),a.paymentMethodToggle()},creditCardTypeToggle:function(e){n.$fieldPreview.find(".wpforms-paypal-commerce-"+l(this).data("card")+"-icon").toggleClass("wpforms-hidden",!e.target.checked),n.$fieldOptions.find(".wpforms-field-option-row-credit_cards input").each(function(){if(l(this).is(":checked"))return n.$fieldPreview.find(".wpforms-paypal-commerce-no-credit-card-type-warning").addClass("wpforms-hidden"),!1;n.$fieldPreview.find(".wpforms-paypal-commerce-no-credit-card-type-warning").removeClass("wpforms-hidden")})},cardHolderToggle:function(e){n.$fieldOptions.find('.wpforms-field-option-row-card_holder input[type="text"]').toggleClass("wpforms-hidden",!e.target.checked),n.$fieldPreview.find(".wpforms-paypal-commerce-card-holder-name").toggleClass("wpforms-hidden",!e.target.checked)},cardSublabels:function(){var e=l(this),o=e.val(),o=o||e.attr("placeholder");n.$fieldPreview.find(".wpforms-paypal-commerce-"+e.data("sublabel")+" .wpforms-sub-label").html(o)},defaultMethodSelect:function(){var e="paypal_checkout"===l(this).val();n.$fieldPreview.find(".wpforms-paypal-commerce-payment-method select").children(":selected").text(l(this).children(":selected").text()),n.$fieldPreview.find(".wpforms-paypal-commerce-credit-card-warning").toggleClass("wpforms-hidden",!e),n.$fieldPreview.find(".wpforms-paypal-commerce-paypal-checkout-warning").addClass("wpforms-hidden")},paymentMethodToggle:function(){var e=a.isCheckoutEnabled(),o=a.isCreditCardEnabled();n.$fieldOptions.find(".wpforms-field-option-row-default_method").toggleClass("wpforms-hidden",!e||!o),n.$fieldPreview.find(".wpforms-paypal-commerce-payment-method").toggleClass("wpforms-hidden",!e||!o),n.$fieldPreview.find(".wpforms-paypal-commerce-no-payment-method-warning").toggleClass("wpforms-hidden",e||o)},disableNotifications:function(){var e=l('.wpforms-panel-content-section-notifications [id*="-paypal-commerce-wrap"]');e.find('input[id*="-paypal-commerce"]').prop("checked",!1),e.addClass("wpforms-hidden")},optionButtonSizeChange:function(){n.$buttonsWrapper.removeClass(),n.$buttonsWrapper.addClass("size-"+l(this).val())},optionShapeChange:function(){var e="wpforms-paypal-commerce-paypal-shape-"+l(this).val();n.$checkoutButton.removeClass(function(e,o){return(o.match(/(^|\s)wpforms-paypal-commerce-paypal-shape-\S+/g)||[]).join("")}),n.$checkoutButton.addClass(e)},optionColorChange:function(){var e=l(this).val();n.$checkoutButton.removeClass(),n.$checkoutButton.addClass("wpforms-paypal-commerce-paypal-checkout-button-"+e),n.$checkoutButtonLogo.removeClass(),["black","blue"].includes(e)?n.$checkoutButtonLogo.addClass("wpforms-paypal-commerce-paypal-checkout-button-logo-white"):n.$checkoutButtonLogo.addClass("wpforms-paypal-commerce-paypal-checkout-button-logo-blue"),n.$fieldOptions.find(".wpforms-field-option-row-shape select").change()},hideSubmitDefault:function(){var e;a.isTargetFieldAdded()&&(e=l(".wpforms-preview .wpforms-field-submit"),a.isCheckoutEnabled()?e.hide():e.show())},isPaymentsEnabled:function(){return n.$singlePaymentControl.is(":checked")||n.$recurringPaymentControl.is(":checked")},isCheckoutEnabled:function(){return n.$fieldOptions.find(".wpforms-field-option-paypal-checkout").is(":checked")},isCreditCardEnabled:function(){return n.$fieldOptions.find(".wpforms-field-option-credit-card").is(":checked")},isAJAXSubmitEnabled:function(){return n.$AJAXSubmitOption.is(":checked")},unCheckEnabledPayments:function(){n.$singlePaymentControl.prop("checked",!1).trigger("change"),n.$recurringPaymentControl.prop("checked",!1).trigger("change"),n.$panelContent.find(".wpforms-panel-content-section-payment").each(function(){l(this).removeClass("wpforms-panel-content-section-payment-open")})},updatePlanData:function(e){if(void 0!==e.paypal_commerce_plans)for(var o in e.paypal_commerce_plans)l("#wpforms-panel-field-paypal_commerce-recurring-"+o+"-pp_product_id").val(e.paypal_commerce_plans[o].pp_product_id),l("#wpforms-panel-field-paypal_commerce-recurring-"+o+"-pp_plan_id").val(e.paypal_commerce_plans[o].pp_plan_id)},updateFormState:function(){wpf.savedState=wpf.getFormState("#wpforms-builder-form")},disableFields:function(){var p=!1;n.$panelContent.find(".wpforms-panel-content-section-payment-plan").each(function(){var e,o,t,n,a,i,r=l(this),d=r.data("plan-id");r.find("#wpforms-panel-field-paypal_commerce-recurring-"+d+"-pp_product_id").val()&&(e=l('<i class="fa fa-question-circle-o wpforms-help-tooltip"></i>'),o=l('<input type="hidden"></input>'),n=(t=r.find("#wpforms-panel-field-paypal_commerce-recurring-"+d+"-name-wrap")).find("input"),i=(a=r.find("#wpforms-panel-field-paypal_commerce-recurring-"+d+"-product_type-wrap")).find("select"),d=(r=r.find("#wpforms-panel-field-paypal_commerce-recurring-"+d+"-recurring_times-wrap")).find("select"),n.attr("disabled","disabled"),t.prepend(o.clone().attr("name",n.attr("name")).val(n.val())),t.find(".wpforms-help-tooltip").remove(),t.find("label").append(e.clone().attr("title",wpforms_builder.paypal_commerce_plan_name_disabled)),i.attr("disabled","disabled"),a.prepend(o.clone().attr("name",i.attr("name")).val(i.val())),a.find(".wpforms-help-tooltip").remove(),a.find("label").append(e.clone().attr("title",wpforms_builder.paypal_commerce_product_type_disabled)),d.attr("disabled","disabled"),r.prepend(o.clone().attr("name",d.attr("name")).val(d.val())),r.find(".wpforms-help-tooltip").remove(),r.find("label").append(e.clone().attr("title",wpforms_builder.paypal_commerce_recurring_times_disabled)),p=!0)}),p&&(wpf.initTooltips(),a.updateFormState())}};return a}(document,(window,jQuery));WPFormsBuilderPaypalCommerce.init();